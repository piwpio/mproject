<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="socketio.js" type="text/javascript"></script>
    <script src="jquery.js" type="text/javascript"></script>
    <script>
        var socket = io();
        socket.on('connected', function() {
            $('#loading').hide();
            $('#loaded').show();
            socket.emit('init_hero')
        });
        socket.on('chat_response', function(r) {
            console.log(r);

        });
        socket.on('hero_response', function(r) {
            console.log(r);
        });
        socket.on('location_response', function(r) {
            console.log(r);
            if (r['chat'] !== undefined) {
                $("#chat").append("<span style='display:block;'><b>" + r['chat'][0] + ": </b>" + r['chat'][1] + "</span>");
            }
        });

        socket.on('response_error', function(error) {
            console.log('response_error', error.message);
        });

        function left()
        {
            socket.emit('move_left');
        }

        function right()
        {
            socket.emit('move_right');
        }

        function attack()
        {
            socket.emit('fight_attack', {eid: 0, et: 'm'});
        }

        function showHeroes()
        {
            socket.emit('debug_logged_show_heroes', function(d) {
                console.log(d);
            });
        }
        function who()
        {
            socket.emit('debug_hero_who');
        }

        // window.intervalId = setInterval(function() {
        //     attack();
        // }, 1000);

        $(function() {
            $("#message-form").on("submit", function(e) {
                e.preventDefault();
                var messageInput = $("#message-input");
                var message = messageInput.val();
                socket.emit('chat_message', {m: message});
                $("#chat").append(
                    "<span style='display:block'><b>me: </b>" + message + "</span>"
                );
                messageInput.val("");
                return false;
            });
        });

    </script>
</head>

<body>

<div id="loading" style="width:100%; height:100%; background:black; position:absolute; top:0; left: 0; right:0; bottom:0;">
    <span style="color:white">LOADING...</span>
</div>
<div id="loaded" style="display: none; width:100%; height:100%; background:yellow; position:absolute; top:0; left: 0; right:0; bottom:0;">
    <button onclick="left()" style="position: absolute; left: 0; top: 50px;">LEFT</button>
    <button onclick="attack()" style="position: absolute; left: 50%; margin-left:-20px; top: 50px;">ATTACK</button>
    <button onclick="right()" style="position: absolute; right:0; top: 50px;">RIGHT</button>
    <div style="position: absolute; top: 100px;">
        <button onclick="who()">WHO AM I</button>
        <button onclick="showHeroes()">SHOW HEROES</button>
    </div>
    <div id="chat" style="position: absolute; background: mintcream; height: 200px; width:100%; top: 200px;">
        <form id="message-form">
            <label for="message-input"></label>
            <input id="message-input" autocomplete="off" style="width:100%; position: absolute; bottom: 0">
        </form>
    </div>
</div>

</body>
</html>